p8105\_hw3\_eh2928
================
Emil Hafeez (eh2928)
2020-10-07

\#Basic Setup

``` r
knitr::opts_chunk$set(echo = TRUE)

#Load relevant libraries, including for Problems 1 and 3
library(tidyverse)
```

    ## ── Attaching packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──

    ## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
    ## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
    ## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
    ## ✓ readr   1.3.1     ✓ forcats 0.5.0

    ## ── Conflicts ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(p8105.datasets)

#Prep for neater output
knitr::opts_chunk$set(
    fig.width = 6, 
  fig.asp = .6,
  out.width = "90%"
)

#Trying a darker theme, at least at first
theme_set(theme_dark() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

\#Problem 1

``` r
data("instacart")
```

This large dataset describes online grocery store purchases and contains
15 columns and a whopping 1384617 rows, where each row is a product from
a user’s order. The products are organized by characteristics like the
department, aisle, name, and numeric code, plus whether the product was
reordered by the user, in what order it was added to the user’s cart,
the day of the week, days since its last order, and more. The users are
demarcated by ID.

``` r
instacart %>% 
  count(aisle) %>% 
    arrange(desc(n))
```

Fresh vegetables, fresh fruits, and packaged vegetables & fruits are the
top three aisles from which products are most commonly ordered.

``` r
instacart %>% 
    count(aisle) %>% 
    filter(n > 10000) %>% 
    mutate(
        aisle = factor(aisle),
        aisle = fct_reorder(aisle, n)
    ) %>% 
    ggplot(aes(x = aisle, y = n)) + 
    geom_point() + 
    theme(axis.text.x = element_text(angle = -90, vjust = .5, hjust = 1))
```

<img src="p8105_hw3_eh2928_files/figure-gfm/plot per-aisle orders, limiting to 10,000+ orders-1.png" width="90%" />
It appears that fresh vegetables and fresh fruits in particular are
ordered with a much higher frequency than other aisles, and packaged
fruits and vegetables is a distant yet still popular third. There is a
sharp decrease to less popular aisles after the first two aisles, and
the frequency levels out steadily after the first ten or so most popular
aisles.

Table time\! Most popular items in each of 3 specific aisles, along with
the number of times they were ordered.

``` r
instacart %>% 
    filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
    group_by(aisle) %>% 
    count(product_name) %>% 
    mutate(rank = min_rank(desc(n))) %>% 
    filter(rank < 4) %>% 
    arrange(aisle, rank) %>% 
    knitr::kable()
```

| aisle                      | product\_name                                 |    n | rank |
| :------------------------- | :-------------------------------------------- | ---: | ---: |
| baking ingredients         | Light Brown Sugar                             |  499 |    1 |
| baking ingredients         | Pure Baking Soda                              |  387 |    2 |
| baking ingredients         | Cane Sugar                                    |  336 |    3 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |    1 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |    2 |
| dog food care              | Small Dog Biscuits                            |   26 |    3 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |    1 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |    2 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |    3 |

Packaged fruits have the most orders among these (as noted, a very
popular category). Spinach, raspberries, and blueberries are the most
popular. Baking products (brown sugar, baking soda, cane sugar) sound
great. Dog food and care have low order numbers in comparison, and are
in order of treats, food, and biscuits.

``` r
instacart %>% 
    filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
    group_by(product_name, order_dow) %>% 
    summarize(mean_hour = mean(order_hour_of_day)) %>% 
    pivot_wider(
        names_from = order_dow,
        values_from = mean_hour
    )
```

    ## `summarise()` regrouping output by 'product_name' (override with `.groups` argument)

    ## # A tibble: 2 x 8
    ## # Groups:   product_name [2]
    ##   product_name       `0`   `1`   `2`   `3`   `4`   `5`   `6`
    ##   <chr>            <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1 Coffee Ice Cream  13.8  14.3  15.4  15.3  15.2  12.3  13.8
    ## 2 Pink Lady Apples  13.4  11.4  11.7  14.2  11.6  12.8  11.9

Here, we can see that the mean hour of product ordering tends to be
between the 11.0 and 15.5 hours of the day (11am and 3:30pm). The
overall latest ordering day of the week seems to be Wednesday, and the
earliest appears to be Friday.

# Problem Two

``` r
accel_df =
  read_csv(
      "./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    activity_1:activity_1440,
    names_to = "minute_per_day",
    values_to = "activity_count"
  ) %>% 
  mutate(minute_per_day = str_remove_all(minute_per_day, "activity_"),
         minute_per_day = as.numeric(minute_per_day))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double(),
    ##   day = col_character()
    ## )

    ## See spec(...) for full column specifications.

I notice that there are 50,400 observations (minutes) but there should
be (1400\*) = 49000 observations.
